<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<link href="https://cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.css" rel="stylesheet" />
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
<script src="https://cdn.datatables.net/1.10.7/js/jquery.dataTables.min.js"></script>
<script src="https://cdn.datatables.net/plug-ins/1.10.7/integration/bootstrap/3/dataTables.bootstrap.js"></script>

<h1>List of PRs</h1>

{% if pr_list %}
<table class="table" id="pr_table">
    <thead>
        <tr>
            <th>#</th>
            <th>Title</th>
            <th>State</th>
            <th>Duration</th>
            <th>Links</th>
        </tr>
    </thead>

    <tbody>
        {% for pull in pr_list %}
        <tr class="{{pull.alert}}">
            <td><a href="{% url 'pr_stats:detail' pull.number %}">{{ pull.number }}</a></td>
            <td><a href="{% url 'pr_stats:detail' pull.number %}">{{ pull.title }}</a></td>
            <td>{{ pull.state }}</td>
            <td data-order="{{ pull.time_open_sec }}">{{ pull.time_open }}</td>
            <td>GitHub</td>
        </tr>
        {% endfor %}
    </tbody>


</table>
{% else %}
<p>No polls are available.</p>
{% endif %}

<p><a href="{% url 'pr_stats:pulls' %}">Load data</a></p>
<p><a href="{% url 'pr_stats:statistics' %}">Stats</a></p>

<div id="timeline" style="height: 600px;"></div>

<script>
$(document).ready(function() {
$('#pr_table').dataTable();
});
</script>

<script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
<script type="text/javascript">
      google.charts.load('current', {'packages':['timeline']});
      google.charts.setOnLoadCallback(drawChart);
      function drawChart() {
        var container = document.getElementById('timeline');
        var chart = new google.visualization.Timeline(container);
        var dataTable = new google.visualization.DataTable();

        dataTable.addColumn({ type: 'string', id: 'PullRequest' });
        dataTable.addColumn({ type: 'date', id: 'Start' });
        dataTable.addColumn({ type: 'date', id: 'End' });
        dataTable.addRows([
        {% for pull in pr_list %}
          [ '{{pull.title}}', new Date({{ pull.created_at_js}}), new Date({{pull.closed_at_js}}) ] {% if not forloop.last %},{% endif %}
        {% endfor %}
          ]);

        chart.draw(dataTable);
      }
</script>
